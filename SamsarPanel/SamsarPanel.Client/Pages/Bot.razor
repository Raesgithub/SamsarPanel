@page "/AAA"
@inject IJSRuntime JSRuntime
@rendermode @(new InteractiveAutoRenderMode(false))
<div class="container py-5 text-center">
    <h3 class="fw-bold text-primary">پیام آماده سروش</h3>
    <p class="text-muted fs-5">
        روی دکمه زیر کلیک کنید تا پیام آماده در وب سروش باز شود و سپس دکمه ارسال را بزنید.
    </p>
    <button class="btn btn-success btn-lg" @onclick="OpenSoroush">
        باز کردن پیام در سروش
    </button>
</div>

@code {
    private string subject = "سفارش جدید";
    private string message = "کاربر فرم را پر کرده است";
    private string fullName = "علی محمدی";
    private string phone = "09123456789";
    private string email = "user@example.com";

    private string myPhone = "09910144115"; // شماره شما بدون +

    private async Task OpenSoroush()
    {
        var sb = new System.Text.StringBuilder();
        sb.AppendLine($"📩 موضوع: {subject}");
        sb.AppendLine($"📝 پیام: {message}");
        sb.AppendLine();
        sb.AppendLine("---");
        sb.AppendLine("📍 اطلاعات کاربر برای تماس مدیر:");
        sb.AppendLine($"👤 نام: {fullName}");
        sb.AppendLine($"📞 موبایل: {phone}");
        sb.AppendLine($"📧 ایمیل: {email}");

        string finalMessage = sb.ToString();

        // لینک نسخه وب سروش پلاس
        string url = $"https://web.splus.ir/send?phone={myPhone}&text={Uri.EscapeDataString(finalMessage)}";

        await JSRuntime.InvokeVoidAsync("open", url, "_blank");
    }
}
